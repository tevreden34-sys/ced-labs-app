<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Ced Weather Dashboard</title>
<style>
body{margin:0;background:#1a070a;color:#eaf0ff;font-family:Arial,sans-serif}
.wrap{max-width:1000px;margin:0 auto;padding:20px}
h1{margin:0 0 14px}
.row{display:flex;gap:8px;margin-bottom:12px}
input,button{padding:10px;border-radius:10px;border:1px solid #2a3a57;background:#111a2b;color:#fff}
button{cursor:pointer}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.card{background:#101a2d;border:1px solid #213351;border-radius:12px;padding:12px}
#temp{font-size:34px;font-weight:bold}
#hourly{display:grid;grid-template-columns:repeat(3,1fr);gap:8px}
.hour{background:#0f1525;border:1px solid #1d2a42;border-radius:10px;padding:8px;font-size:13px}
iframe{width:100%;height:420px;border:0;border-radius:12px}
@media(max-width:800px){.grid{grid-template-columns:1fr}}
</style>
</head>
<body>
<main class="wrap">
<h1>Weather Dashboard</h1>
<div class="row">
<input id="locationInput" value="Maastricht" placeholder="Location (city)" />
<button id="loadBtn">Load</button>
</div>

<section class="grid">
<article class="card">
<h2>Current</h2>
<p id="place">-</p>
<p id="temp">-</p>
<p id="summary">-</p>
<p id="details">-</p>
</article>
<article class="card">
<h2>Full Weather (next hours)</h2>
<div id="hourly"></div>
</article>
</section>

<section class="card">
<h2>Live Location Feed (map)</h2>
<iframe id="map"></iframe>
</section>
</main>

<script>
const code = {0:'Clear',1:'Mainly clear',2:'Partly cloudy',3:'Overcast',45:'Fog',51:'Drizzle',53:'Drizzle',55:'Dense drizzle',61:'Rain',63:'Rain',65:'Heavy rain',71:'Snow',80:'Rain showers',95:'Thunderstorm'};
const $ = id => document.getElementById(id);

async function geocode(name){
const r = await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(name)}&count=1&language=en&format=json`);
const d = await r.json();
if(!d.results?.length) throw new Error('Location not found');
return d.results[0];
}

async function weather(lat,lon){
const r = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,apparent_temperature,relative_humidity_2m,wind_speed_10m,weather_code&hourly=temperature_2m,weather_code&forecast_days=2&timezone=auto`);
return r.json();
}

function renderHourly(h){
const box = $('hourly'); box.innerHTML='';
const now = new Date(); let shown=0;
for(let i=0;i<h.time.length && shown<6;i++){
const t = new Date(h.time[i]); if(t<now) continue;
const el = document.createElement('div'); el.className='hour';
el.innerHTML = `<div>${t.toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'})}</div><div><b>${Math.round(h.temperature_2m[i])}°C</b></div><div>${code[h.weather_code[i]]||'-'}</div>`;
box.appendChild(el); shown++;
}
}

function setMap(lat,lon){
const d = 0.03; // tighter city zoom
$('map').src=`https://www.openstreetmap.org/export/embed.html?bbox=${lon-d}%2C${lat-d}%2C${lon+d}%2C${lat+d}&layer=mapnik&marker=${lat}%2C${lon}`;
}

async function load(){
const q = $('locationInput').value.trim(); if(!q) return;
const p = await geocode(q); const w = await weather(p.latitude,p.longitude); const c=w.current;
$('place').textContent = `${p.name}, ${p.country||''}`;
$('temp').textContent = `${Math.round(c.temperature_2m)}°C`;
$('summary').textContent = code[c.weather_code] || 'Unknown';
$('details').textContent = `Feels ${Math.round(c.apparent_temperature)}°C · Humidity ${c.relative_humidity_2m}% · Wind ${Math.round(c.wind_speed_10m)} km/h`;
renderHourly(w.hourly); setMap(p.latitude,p.longitude);
}

$('loadBtn').onclick = load;
$('locationInput').addEventListener('keydown', e => e.key==='Enter' && load());
load();
</script>
</body>
</html>
